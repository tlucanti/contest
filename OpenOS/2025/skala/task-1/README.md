
# Модуль динамического включения / выключения CPU

## Сборка

сборка объекта модуля:
```
make
```

## Загрузка модуля

```
make install
```

## Выгрузка модуля
```
make uninstall
```

# Описание работы

## Выключение CPU

После загрузки модуля доступ к функционалу производится чере sysfs директорию
```
/sys/kernel/cpu_control
```

содержащую 3 файла:
```
enable
disable
toggle
```

запись идентификатора в каждый из соответсвующих файлов приведет к:

 - enable:
   - включению CPU: `echo 1 | tee /sys/kernel/cpu_control/enable`
 - disable:
   - вылючению CPU: `echo 1 | tee /sys/kernel/cpu_control/disable`
 - toggle:
   - смене состояния на противоположное: `echo 1 | tee /sys/kernel/cpu_control/toggle`

# Описание реализации

Модуль стартует с `__init` функции загрузки модуля, которая создает объект
и его аттрибуты в sysfs, добавляет его в иерархию

При выгрузке модуля вызывается `__exit` функция, которая уничтожает объект
ядра и его аттрибуты из sysfs.

При записи в файл `/sys/kernel/cpu_control/enable` номера, CPU с соответствующим
ID включается в режиме hotplug (после проверки валидности cpu id), с помощью
функции `add_cpu`, которая находит struct device нужного CPU и вызывает
device_online для него.

Аналогично при записи в файл `/sys/kernel/cpu_control/disable` номера CPU,
производится hotplug отключение этого CPU, с помощью функции `remove_cpu`.

И так же, при запиуи в файл `/sys/kernel/cpu_control/toggle` номера CPU
производится смена состояния: включенный CPU выключается, выклченный CPU
включается.

Все действия снабжены логгированием в системный журнал.

Так же можно отметить, что реализация является thread-safe, так как функции
add_cpu и remove_cpu содержат внутри обращения к примитиву синхронизации
для hotplug устройств
